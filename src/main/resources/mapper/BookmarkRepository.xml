<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lec.spring.repository.mypage.BookmarkRepository">

    <resultMap id="mapCocktail" type="com.lec.spring.domain.menu.Menu">
        <result column="m_id" property="id"/>
        <result column="m_name" property="name"/>
        <result column="m_imgUrl" property="imgUrl"/>
        <result column="m_sequence" property="sequence"/>
    </resultMap>

    <resultMap id="mapBookmark" type="com.lec.spring.domain.mypage.Bookmark">
        <result column="b_menu_id" property="menu_id"/>
        <result column="b_comment" property="comment"/>
        <result column="b_user_id" property="user_id"/>
        <collection property="menu" resultMap="mapCocktail"/>
    </resultMap>

    <!-- 특정 유저(id) 의 즐겨찾기 목록 -->
    <select id="findByUser" resultMap="mapBookmark">
        SELECT
            b.cocktail_id "b_menu_id",
            b.comment "b_comment",
            b.user_id "b_user_id",
            m.id "m_id",
            m.name "m_name",
            m.img_url "m_imgUrl",
            m.sequence "m_sequence"
        FROM ctt_bookmark b, ctt_menu m
        WHERE b.cocktail_id = m.id AND b.user_id = #{user_id}
    </select>

</mapper>
