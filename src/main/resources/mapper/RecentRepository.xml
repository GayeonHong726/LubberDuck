<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lec.spring.repository.recent.RecentRepository">

    <resultMap id="mapCocktail" type="com.lec.spring.domain.menu.Menu">
        <result column="m_id" property="id"/>
        <result column="m_name" property="name"/>
        <result column="m_imgUrl" property="imgUrl"/>
        <result column="m_sequence" property="sequence"/>
    </resultMap>

    <resultMap id="mapRecent" type="com.lec.spring.domain.recent.Recent">
        <result column="r_user_id" property="user_id"/>
        <result column="r_menu_id" property="menu_id"/>
        <result column="r_saw_date" property="saw_date"/>
        <collection property="menu" resultMap="mapCocktail"/>
    </resultMap>

    <select id="findByUser" resultMap="mapRecent">
        SELECT
            r.cocktail_id "r_menu_id",
            r.user_id "r_user_id",
            r.saw_date "r_saw_date",
            m.id "m_id",
            m.name "m_name",
            m.img_url "m_imgUrl",
            m.sequence "m_sequence"
        FROM ctt_recent r, ctt_menu m
        WHERE r.cocktail_id = m.id AND r.user_id = #{user_id}
    </select>



</mapper>