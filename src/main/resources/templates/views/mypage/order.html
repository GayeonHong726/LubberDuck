<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" type="text/css" th:href="@{/css/common.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/common/header.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/common/sidebar.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/mypage/order.css}"> <!-- 해당 경로에 CSS 넣기 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Freeman&family=League+Gothic&family=Meddon&family=Sacramento&family=Staatliches&family=Teko:wght@300..700&display=swap" rel="stylesheet">

</head>
<body>
<!--/* 헤더 */-->
<th:block th:insert="~{common/header::header}"></th:block>

<div class="all">
    <!-- sidebar -->
    <th:block th:insert="~{common/sidebar::sidebar}"></th:block>

    <div class="article">
        <div class="container">
            <div class="receipt" th:each="order : ${orders}">
                <div class="background">
                    <img th:src="@{/img/mypage/receipt.png}">
                </div>
                <div class="content">
                    <h2 class="shopname">LubberDuck</h2>
                    <div class="header-info">
                        <p class="name" th:text="${user.nickname + '님'}">User</p>
                        <p class="date-time" th:text="${order.regdate}"></p>
                    </div>
                    <p class="order-nm" th:text="'주문번호: ' + ${order.id}">주문번호: 25623</p>
                    <div class="dashed"></div>
                    <div class="item-header">
                        <span class="menuName">&lt;메뉴이름&gt;</span>
                        <span class="quantity">&lt;주문수량&gt;</span>
                        <span class="menuPrice">&lt;메뉴가격&gt;</span>
                        <span class="review">&lt;리뷰작성&gt;</span>
                    </div>
                    <div class="dashed"></div>
                    <div class="items" th:each="item : ${orderItemsByOrderId[order.id]}">
                        <div class="item">
                            <span class="item-name" th:text="${item.menu.name}">Daiquiri</span>
                            <span class="quantity" th:text="${item.quantity}">1</span>
                            <span class="item-price" th:text="${item.price}">8,900원</span>
                            <span>
                                <input type="button" value="리뷰작성" name="reviewBtn">
                            </span>
                        </div>
                    </div>
                    <div class="dashed"></div>
                    <div class="totals">
                        <div class="total-item">
                       <span class="total-price" th:with="total=0">
                            <!-- 주문 항목들을 순회하며 subtotal 계산 -->
                            <span th:each="item : ${orderItemsByOrderId[order.id]}" th:with="subtotal=${item.quantity * item.price}">
                                <!-- total 변수 갱신 -->
                                <span th:with="total=${total + subtotal}">
                                    <!-- total 값 출력 -->
                                    <span th:text="${total}"></span>
                                </span>
                            </span>
                        </span>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
